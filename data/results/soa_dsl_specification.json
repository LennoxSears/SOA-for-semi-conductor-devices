{
  "specification": {
    "soa_dsl": {
      "version": "1.0",
      "description": "Unified Domain Specific Language for SOA Rules",
      "syntax": {
        "variables": {
          "voltage": "v[pin1, pin2] or v[pin]",
          "current": "i[pin] or i[device]",
          "temperature": "T or temp",
          "parameters": "$param_name or device.param",
          "constants": "numeric values or named constants"
        },
        "operators": {
          "arithmetic": "+ - * / ^ ()",
          "comparison": "< <= > >= == !=",
          "logical": "&& || !",
          "functions": "min() max() abs() sqrt() exp() log()"
        },
        "constraints": {
          "simple": "value or range",
          "equation": "mathematical expression",
          "conditional": "if condition then expr1 else expr2",
          "tmaxfrac": "time_level: constraint_value"
        }
      },
      "rule_structure": {
        "required_fields": [
          "id",
          "name",
          "device_type",
          "parameter",
          "rule_type",
          "severity"
        ],
        "optional_fields": [
          "tmaxfrac",
          "metadata",
          "description"
        ],
        "constraint_types": [
          "vlow",
          "vhigh",
          "ilow",
          "ihigh",
          "custom"
        ]
      }
    }
  },
  "grammar": "\n        # SOA DSL Grammar (EBNF-style)\n        \n        rule := rule_header constraint_block [tmaxfrac_block] [metadata_block]\n        \n        rule_header := 'rule' rule_id '{' \n                      'name:' string ','\n                      'device:' device_spec ','\n                      'parameter:' parameter_spec ','\n                      'type:' rule_type ','\n                      'severity:' severity_level\n                      '}'\n        \n        constraint_block := 'constraints' '{' constraint_list '}'\n        constraint_list := constraint (',' constraint)*\n        constraint := constraint_name ':' expression\n        \n        tmaxfrac_block := 'tmaxfrac' '{' tmaxfrac_list '}'\n        tmaxfrac_list := tmaxfrac_entry (',' tmaxfrac_entry)*\n        tmaxfrac_entry := float_literal ':' expression\n        \n        expression := simple_expr | equation_expr | function_expr | conditional_expr\n        \n        simple_expr := number | range\n        equation_expr := math_expression\n        function_expr := function_name '(' argument_list ')'\n        conditional_expr := 'if' condition 'then' expression 'else' expression\n        \n        math_expression := term (('+' | '-') term)*\n        term := factor (('*' | '/') factor)*\n        factor := number | variable | '(' math_expression ')'\n        \n        variable := voltage_var | current_var | temp_var | param_var\n        voltage_var := 'v[' pin_list ']'\n        current_var := 'i[' pin_list ']'\n        temp_var := 'T' | 'temp'\n        param_var := '$' identifier\n        \n        pin_list := identifier (',' identifier)*\n        ",
  "examples": [
    {
      "id": "nmos_core_vds_simple",
      "name": "NMOS Core VDS Simple Limit",
      "device_type": "mos_transistor",
      "device_category": "core_nmos",
      "parameter": "v[d,s]",
      "rule_type": "voltage",
      "severity": "high",
      "constraints": {
        "vhigh": {
          "type": "simple",
          "expression": "1.65",
          "variables": [
            {
              "name": "v[d,s]",
              "type": "voltage",
              "pins": [
                "d",
                "s"
              ],
              "description": null
            }
          ],
          "description": null
        }
      },
      "tmaxfrac": null,
      "metadata": null
    },
    {
      "id": "diode_temp_dependent",
      "name": "Diode Temperature Dependent Forward Voltage",
      "device_type": "diode",
      "device_category": "zener",
      "parameter": "v[p,n]_forward",
      "rule_type": "voltage",
      "severity": "review",
      "constraints": {
        "vhigh": {
          "type": "equation",
          "expression": "0.9943 - (0.0006 * (T - 25))",
          "variables": [
            {
              "name": "T",
              "type": "temperature",
              "pins": null,
              "description": "Junction temperature"
            },
            {
              "name": "v[p,n]",
              "type": "voltage",
              "pins": [
                "p",
                "n"
              ],
              "description": null
            }
          ],
          "description": null
        }
      },
      "tmaxfrac": null,
      "metadata": null
    },
    {
      "id": "diode_multi_pin_function",
      "name": "Diode Multi-Pin with Min Function",
      "device_type": "diode",
      "device_category": "power",
      "parameter": "v[n,p]_reverse",
      "rule_type": "voltage",
      "severity": "review",
      "constraints": {
        "vlow": {
          "type": "function",
          "expression": "min(90, 90 + v[p] - v[sub])",
          "variables": [
            {
              "name": "v[p]",
              "type": "voltage",
              "pins": [
                "p"
              ],
              "description": null
            },
            {
              "name": "v[sub]",
              "type": "voltage",
              "pins": [
                "sub"
              ],
              "description": null
            },
            {
              "name": "v[n,p]",
              "type": "voltage",
              "pins": [
                "n",
                "p"
              ],
              "description": null
            }
          ],
          "description": null
        }
      },
      "tmaxfrac": null,
      "metadata": null
    },
    {
      "id": "resistor_current_limit",
      "name": "Resistor Current Limit with Width Dependency",
      "device_type": "resistor",
      "device_category": "poly",
      "parameter": "i[resistor]",
      "rule_type": "current",
      "severity": "error",
      "constraints": {
        "imax": {
          "type": "equation",
          "expression": "$w * $np * 2.12e-4",
          "variables": [
            {
              "name": "$w",
              "type": "parameter",
              "pins": null,
              "description": "Device width"
            },
            {
              "name": "$np",
              "type": "parameter",
              "pins": null,
              "description": "Number of parallel segments"
            },
            {
              "name": "i[resistor]",
              "type": "current",
              "pins": null,
              "description": null
            }
          ],
          "description": null
        }
      },
      "tmaxfrac": null,
      "metadata": null
    },
    {
      "id": "nmos_tmaxfrac_constraint",
      "name": "NMOS Core with tmaxfrac Levels",
      "device_type": "mos_transistor",
      "device_category": "core_nmos",
      "parameter": "v[d,s]",
      "rule_type": "voltage",
      "severity": "high",
      "constraints": {
        "vhigh_steady": {
          "type": "simple",
          "expression": "1.65",
          "variables": [
            {
              "name": "v[d,s]",
              "type": "voltage",
              "pins": [
                "d",
                "s"
              ],
              "description": null
            }
          ],
          "description": null
        }
      },
      "tmaxfrac": {
        "levels": {
          "0.1": 1.71,
          "0.01": 1.84,
          "0.0": 1.65
        },
        "description": "Transient maximum fraction constraint"
      },
      "metadata": null
    },
    {
      "id": "bjt_conditional_limit",
      "name": "BJT Conditional Voltage Limit",
      "device_type": "bjt",
      "device_category": "npn",
      "parameter": "v[c,e]",
      "rule_type": "voltage",
      "severity": "high",
      "constraints": {
        "vhigh": {
          "type": "conditional",
          "expression": "if (T > 85) then 10.0 else 12.0",
          "variables": [
            {
              "name": "T",
              "type": "temperature",
              "pins": null,
              "description": null
            },
            {
              "name": "v[c,e]",
              "type": "voltage",
              "pins": [
                "c",
                "e"
              ],
              "description": null
            }
          ],
          "description": null
        }
      },
      "tmaxfrac": null,
      "metadata": null
    }
  ],
  "implementation_notes": {
    "parser": "ANTLR4 or PLY (Python Lex-Yacc) recommended",
    "validation": "Type checking and constraint validation required",
    "code_generation": "Target languages: Python, C++, Verilog-A",
    "testing": "Automated test case generation from rules"
  }
}